<!doctype html>
<html lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Temporary, pseudo-experiment</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <script src="https://unpkg.com/peerjs@1.3.1/dist/peerjs.min.js"></script>
        <script src="https://unpkg.com/uuid@latest/dist/umd/uuidv4.min.js"></script>
        <style type="text/css" media="screen">
         body {
             overflow: hidden;
         }
         #dataDisplay {
             overflow: scroll;
             max-height: 600px;
         }
        </style>
    </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">
            You are using an <strong>outdated</strong> browser. Please
            <a href="http://browsehappy.com/">upgrade your browser</a> to improve
            your experience.
            </p>
        <![endif]-->
        <iframe id="simulatedExpScreen" title="ExperimentClient" width="600" height="400"></iframe>
        <div>
            <button type="button" id="newPeer">Generate Peer</button>
            <div id="idReadout" style="display:inline;"><div>
            </div>

        <h3>Received data:</h3>
        <ul id="dataDisplay"></ul>

    </body>
    <script type="text/javascript">
        // import { v4 as uuidv4 } from 'uuid';
        // import Peer from 'peerjs';
     let experimentClientID, peer, conn;
     peer = new Peer();
     // TODO clean this whole file up.
     // TODO restructure project, ie use public folder and /static pathing
     function generatePeerConnection() {
         console.log("Generating ID");
         experimentClientID = uuidv4();
         console.log("Generated the ID: ", experimentClientID);
         document.getElementById("idReadout").setInnerText = experimentClientID;
         const alphabet = 'abcedfghijk';
         const font = 'Sloan';
         const params = {'alphabet': alphabet, 'font': font, 'peerID': experimentClientID};
         let queryString = Object.keys(params)
                                 .map(key => key + '=' + params[key])
                                 .join('&');
         let uri = 'https://testtestgus.xyz/init?' + queryString;
         console.log(uri);
         document.getElementById("simulatedExpScreen").src = uri;
     };
     document.getElementById("newPeer").addEventListener("click", generatePeerConnection);

     peer.on
    </script>

</html>
